---
title: "Agent-based models"
author: "Forrest W. Crawford"
output:
  beamer_presentation: 
    slide_level: 2
    toc: true
  html_document:
    toc: yes
    toc_depth: 4
    toc_float:
      collapsed: FALSE
      smooth_scroll: TRUE
    code_folding: hide
    highlight: haddock
    number_sections: FALSE
    df_print: kable
bibliography: ../phmodeling.bib
---


# Agent-based models

So far we have treated populations as either continuous or discrete but homogeneous in their characteristics.  But sometimes heterogeneity plays a critical role in the dynamics of the process of interest.  

ABMs have basically two important components that distinguish them from other models 
1. Individualistic parameterization
2. Interactions between individuals/groups

Often these are purely simulation models, because it can be difficulty to study their dynamics analytically or learn about them from data.  For example, it can be difficult to answer simple questions like, what is the average HIV prevalence in the population after the intervention? without actually running the model millions of times. 

Sometimes ABMs are so complex they require supercomputers to do the simulation. 

complex behavior/interactions, non-eqilibrium/non-steady-state 

hypothetical effects of interventions that affect individuals differently. 


population 
ecology 
economic behavior
epidemics


at a certain level of granularity, we can't even write a general formalization of an abm.  We just have to specify it by implementing it.  

## Individualistic attributes 



Using individualistic attributes to parameterize rates


## My philosophy

All discrete models are agent-based models, even population-based models.  Population-based compartmental models just assume that all the agents in the same state are homogeneous. 

A lot of statistical models qualify as agent-based models since they incorporate individualistic covariates, and may represent interactions between individuals, or exhibit complex behavior.   

Researchers often hope that ABMs will exhibit _emergent behavior_, or complex dynamics that result from the simulation, but are not explicitly represented in the model structure. However, mostly ABMs just do exactly what researchers parameterize them to do.   



---

### Example: a survival model

Let $T_i$ be the survival (failure) time of subject $i$ in a trial.  We can parameterize the rate, or _hazard_ of failure as 

$$ \lambda_i = \lambda(t) \exp(x_i'\beta) $$

where $\lambda(t)$ is a time-varying hazard common to all subjects, and $\exp(x_i'\beta)$ is the part that depends on subject $i$. This is called the _Cox Proporitional Hazards Model_. This is an agent-based model because the outcomes are specific to each subject/agent. 


---

## Example: individualistic SIR epidemic model 

For subject $j$, let $s_j(t)$ indicate susceptible, $i_j(t)$ indicate infective, and $r_j(t)$ recovered. 

$$Z_j \sim N(\mu,\Sigma) $$
$$ \beta_j(t) = e^{z_j'\theta_0} \left( \alpha + \sum_{k=1}^n y_k(t) e^{z_k'\theta_1}\right) $$
$$ \gamma_j(t) = e^{z_j'\theta_3} $$
then the overall rate of transition $S\to I$ is 
$$ \sum_j \beta_j(t) (1-y_j(t)) $$
and the overall rate of transition from $I\to R$ is 
$$ \sum_j \gamma_j(t) y_j(t) $$ 

Complicated! 

---

```{r, eval=FALSE}

n = 100
z = rnorm(n)
theta0 = -0.3
theta1 = -0.1
theta2 = 0.2
tmax = 10

ezt0 = exp(z * theta0)
ezt1 = exp(z * theta1)
ezt2 = exp(z * theta2)

susceptible = 2:n
infected = c(1)
recovered = c()

t = 0

while(t < tmax) {

  haz_stoi = sum(ezt0[susceptible]) * sum(ezt1[infective])
  w1 = rexp(1,haz_stoi)

  haz_itor = 0
  if(length(recovered)>0) {
    haz_itor = sum(ezt2[infective])
  }
  w2 = rexp(1,haz_itor) 

  if(w1<w2) {
    
    sample(susceptible ....)

  }

  w = min(c(w1,w2))



  if(t + w > tmax) break



  

  t = t + w
  




}

```


---

## More about ABMs


---

## Pitfalls of ABMs

ABMs can be dangerous because they may seem complex, but are always constrained by their structure, parameterization, and calibration.  

- When ABMs give dynamics similar to those observed in the real world, we don't always know whether they are capturing the mechanism correctly.  
- When ABMs give dynamics starkly different from what we see in the real world, we do not always know why.  

Researchers often use ABMs to predict the effect of hypothetical population-level policies before these policies are tested empirically.  This can be dangerous, because assumptions about how agents behave in the absence of the intervention, and how the intervention affects their behavior, may lead researchers to draw erroneous conclusions about a situation that has never before occurred.  

It is very easy to understate uncertainty in predictions/inferences from an ABM because ABMs may not capture all sources of stochasticity in the real world.   

---

Example: 
What if everyone got PrEP? 

---

## Controversies 





---


[[Back: Stochastic Models]](../stochastic/stochastic.html)
[[Home]](../index.html)
[[Next: Network models]](../network/network.html)

---


## References 








